package com.malware.server.maps;

import com.malware.server.utils.UrlReader;

import uk.me.jstott.jcoord.LatLng;

public class GoogleMaps {

	public static String DIRECTIONS_SERVICE_URL = "http://maps.google.com/maps/nav";
	
	public static double getDrivingDistance(LatLng start, LatLng end) {
		String url = generateUrlForDirectionsBetween(start, end);
		String urlContent = UrlReader.getContentfromURL(url);
		
		Route route = new Route(urlContent);
		return route.getDistanceInMetres();
	}
	
	/**
	 * Generate a URL to query Google for directions between start and end points.
	 */
	private static String generateUrlForDirectionsBetween(LatLng start, LatLng end) {
		String url = DIRECTIONS_SERVICE_URL;
		url += "?";
		url += "q=";
		url += "from:" + removeParenthesisAndSpaces(start.toString());
		url += "+to:" + removeParenthesisAndSpaces(end.toString());
		return url;
	}
	
	/**
	 * Removes occurrences of all opening and closing parenthesis
	 * and all spaces from the input string.
	 */
	private static String removeParenthesisAndSpaces(String input) {
		input = input.replace("(", "");
		input = input.replace(")", "");
		input = input.replace(" ", "");
		return input;
	}
}

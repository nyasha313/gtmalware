package com.malware.server.finance;

import java.io.*;
import java.net.*;

public class PaypalTransfer {

	/**
	 * @param args
	 */
		// TODO Auto-generated method stub
		public void transfer(String senderUsername, String password, String signature, String receiverEmail, String amount) throws IOException
		{
			// Set up your API credentials, PayPal end point, API operation and version.
			try {
	    // Construct data
				
				String nvp = URLEncoder.encode("USER", "UTF-8") + "=" + URLEncoder.encode(senderUsername, "UTF-8");
				nvp += "&" + URLEncoder.encode("PWD", "UTF-8") + "=" + URLEncoder.encode(password, "UTF-8");
				nvp += "&" + URLEncoder.encode("SIGNATURE", "UTF-8") + "=" + URLEncoder.encode(signature, "UTF-8");
				nvp += "&" + URLEncoder.encode("VERSION", "UTF-8") + "=" + URLEncoder.encode("2.3", "UTF-8");
				nvp += "&" + URLEncoder.encode("METHOD", "UTF-8") + "=" + URLEncoder.encode("MassPay", "UTF-8");
				nvp += "&" + URLEncoder.encode("RECEIVERTYPE", "UTF-8") + "=" + URLEncoder.encode("EmailAddress", "UTF-8");
				nvp += "&" + URLEncoder.encode("L_EMAIL0", "UTF-8") + "=" + URLEncoder.encode(receiverEmail, "UTF-8");
				nvp += "&" + URLEncoder.encode("L_AMT0", "UTF-8") + "=" + URLEncoder.encode(amount, "UTF-8");
				nvp += "&" + URLEncoder.encode("CURRENCYCODE", "UTF-8") + "=" + URLEncoder.encode("USD", "UTF-8");
	    
				// Send data
				URL url = new URL("https://api-3t.sandbox.paypal.com/nvp");
				URLConnection conn = url.openConnection();
				conn.setDoOutput(true);
				OutputStreamWriter wr = new OutputStreamWriter(conn.getOutputStream());
				wr.write(nvp);
				wr.flush();

				// Get the response
				BufferedReader rd = new BufferedReader(new InputStreamReader(conn.getInputStream()));
				String line;
				while ((line = rd.readLine()) != null) 
				{
					String output=URLDecoder.decode(line, "UTF-8");
					System.out.println(output);
				}
				wr.close();
				rd.close();
			} 
			catch (IOException e) 
			{
				System.out.println("Error!!");
			}
		}
}

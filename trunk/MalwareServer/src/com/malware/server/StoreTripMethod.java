package com.malware.server;

import javax.jdo.PersistenceManager;

import com.malware.common.dto.ServerRequest;
import com.malware.common.dto.ServerResponse;
import com.malware.common.dto.Trip;
import com.malware.common.dto.ServerRequest.ServerMethod;
import com.malware.common.dto.ServerResponse.ResponseCode;

/**
 * This class stores information about a new user into the database.
 */
public class StoreTripMethod {

	public static ServerResponse execute(ServerRequest serverRequest) {
		assert serverRequest.getServerMethod() == ServerMethod.STORE_TRIP;
		
		Trip trip = serverRequest.getTrip();
		storeTrip(trip);
		
		ServerResponse serverResponse = new ServerResponse();
		serverResponse.setResponseCode(ResponseCode.SUCCESS);
		
		return serverResponse;
	}
	
	private static void storeTrip(Trip trip) {
		PersistenceManager pm = PMF.get().getPersistenceManager();
		
		pm.makePersistent(trip);
		
		pm.close();
	}
}

package com.malware.android;

import com.google.gson.Gson;
import com.malware.common.dto.ServerRequest;
import com.malware.common.dto.ServerResponse;
import com.malware.common.dto.User;
import com.malware.common.dto.ServerRequest.ServerMethod;
import com.malware.common.dto.ServerResponse.ResponseCode;

import android.app.Activity;
import android.content.Intent;
import android.os.Bundle;
import android.util.Log;
import android.view.View;
import android.widget.Button;
import android.widget.EditText;

public class MalwareSignup extends Activity {
	public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.malware_signup);
        Button register = (Button) findViewById(R.id.malware_signup_register);
        Button back = (Button) findViewById(R.id.malware_signup_back);
        
        final EditText firstName = (EditText)findViewById(R.id.malware_signup_first_name);
        final EditText lastName = (EditText)findViewById(R.id.malware_signup_last_name);
//        EditText sex = (EditText)findViewById(R.id.malware_signup_sex);
        final EditText address = (EditText)findViewById(R.id.malware_signup_address);
        final EditText city = (EditText)findViewById(R.id.malware_signup_city);
        final EditText zipCode = (EditText)findViewById(R.id.malware_signup_zipcode);
        final EditText email = (EditText)findViewById(R.id.malware_signup_email);
        final EditText phone = (EditText)findViewById(R.id.malware_signup_phone);
        
        register.setOnClickListener(new View.OnClickListener() {
			public void onClick(View view) {
				String fname = firstName.getText().toString();
				String lname = lastName.getText().toString();
				String addr = address.getText().toString();
				String c = city.getText().toString();
				String zip = zipCode.getText().toString();
				String e = email.getText().toString();
				String p = phone.getText().toString();
				
				/* get data here and do sanity checks*/
				if(fname.equalsIgnoreCase("")||
				   lname.equalsIgnoreCase("") ||
				   addr.equalsIgnoreCase("") ||
				   c.equalsIgnoreCase("") ||
				   zip.equalsIgnoreCase("") ||
				   e.equalsIgnoreCase("") ||
				   p.equalsIgnoreCase(""))
				{
        			/* pop up error */
				}
        		else
        		{
        			User u = new User(fname, lname, 'M', addr, c, zip, e, p);
        			ServerRequest s = new ServerRequest();
        			s.setServerMethod(ServerMethod.STORE_NEW_USER);
        			s.setNewUser(u);
        			ServerResponse response = MalwareHttpSender.sendData(s);
        			if(response.getResponseCode() == ResponseCode.SUCCESS)
        			{
        				Log.i("Server Response", "Operation successful");
        			}
        			else
        			{
        				Log.i("Server Response", "Operation failed");
        			}
        		        			
        		}
				
				Intent myIntent = new Intent(view.getContext(), MalwareFacebookConnect.class);
				startActivity(myIntent);
			}
		});
        
        back.setOnClickListener(new View.OnClickListener() {
			public void onClick(View view) {
				setResult(RESULT_CANCELED);
				finish();
			}
		});
	}
}
